<!doctype html>
<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
        <title>Testing javascript applications</title>
    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/theme/white.css" id="theme">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/zenburn.min.css">
        
        <link rel="stylesheet" href="./fontawesome-6.2.0/css/all.min.css">
        <link rel="stylesheet" href="./style.css">
    
        <script src="print.js"></script>
    
    </head>

	<body>

		<div class="reveal">
			<div class="slides">
                <section>
                    <section data-background="#333333">
                        <h2>Web</h2>
                        <h1>Testing JavaScript Applications</h1>
                        <p>Bertil Chapuis</p>
                    </section>
                    <section data-markdown>
                        <textarea data-template>
                            ## <i class="fas fa-tasks"></i> Overview of Today's Class
                            - Quiz about last week's lecture
                            - Correction of last week's assignment
                            - Javascript Arrays and Iterables
                            - Testing Javascript Applications
                              - Unit tests
                              - Integration tests
                              - System tests
                            - Introduction of next week's assignment
                        </textarea>
                    </section>
                </section>

                <section>
                    <section data-background="#333333">
                        <h2><i class="fas fa-question-circle"></i> Quiz</h2>
                        <h3>Object-oriented JavaScript</h3>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Question 1
                            Parmis les types suivant, lequels sont primitifs?
                            - (A) Number
                            - (B) Object
                            - (C) Array
                            - (D) Undefined
                            - (E) Aucune réponse correcte
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                          ## <i class="fas fa-question-circle"></i> Question 2
                          Quelle est la valeur imprimée par le programme suivant?

                          ```js
                          var obj = {
                              "1": 1
                          }
                          console.log(obj[1]);
                          ```

                          - (A) SyntaxError
                          - (B) 1
                          - (C) Undefined
                          - (D) TypeError
                          - (E) NaN
                          - (F) Aucune réponse correcte

                          Notes:

                          <div class="spoiler">

                            Réponse (B).

                            JavaScript tente de trouver une propriété qui porte un nom égal au nom demandé entre les crochets, ici `1`. Puisque JavaScript, par défaut, convertit implicitement deux valeurs comparées dans un type commun (cf. différence `==` et `===`), la propriété `"1"` est considérée porter le nom demandé (`1`), et sa valeur est retournée.

                          </div>

                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Question 3
                            Quelle est la valeur imprimée par le programme suivant?

                            ```js
                            var arr = [];
                            arr[0] = 0;
                            arr[2] = 2;
                            arr[4] = 4;
                            for (var val in arr) {
                                console.log(val)
                            }
                            ```

                            - (A) `0 1 2 3 4`
                            - (B) `0 1 2 3 4 length`
                            - (C) `0 2 4`
                            - (D) `0 null 2 null 4`
                            - (E) `0 undefined 2 undefined 4`
                            - (F) Aucune réponse correcte

                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Question 4
                            Que se passe-t-il lorsque l'on ajoute une fonction au prototype d'une classe de la librarie standard?
                            - (A) Cela est interdit
                            - (B) Les instances futures de la classe hériterons la fonction
                            - (C) La fonction est copiées instantanément dans toutes les instances existantes de la classe
                            - (D) Aucune réponse correcte
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Question 5
                            Quelle est la valeur imprimée par le programme suivant?

                            ```js
                            var age = 20;
                            var student = {
                                age: 25
                            }
                            function get() {
                                return this.student.age;
                            }
                            get.prototype.student = {age: 30};
                            console.log(get());
                            ```

                            - (A) 20
                            - (B) 25
                            - (C) 30
                            - (D) TypeError: Cannot read properties of undefined
                            - (E) aucune réponse correcte
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Question 6
                            Quelle est la valeur imprimée par le programme suivant?

                            ```js
                            var age = 20;
                            var student = {
                                age: 25,
                                get: function() {
                                    return this.age;
                                }
                            }
                            var anotherStudent = {
                                age: 30,
                                get: function() {
                                    return this.age;
                                }
                            }
                            console.log(student.get.apply(anotherStudent))
                            ```

                            - (A) 20
                            - (B) 25
                            - (C) 30
                            - (D) undefined
                            - (E) aucune réponse correcte
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Question 7
                            Quelle est la valeur imprimée par le programme suivant?

                            ```js
                            var age = 20;
                            function Student(age) {
                                this.age = age
                                return {
                                    age: 25
                                }
                            }
                            var student = new Student(30);
                            console.log(student.age)
                            ```

                            - (A) 20
                            - (B) 25
                            - (C) 30
                            - (D) undefined
                            - (E) aucune réponse correcte
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Question 8
                            A quoi correspond la propriété `document.referrer`?

                            - (A) A l'adresse du site Internet visité par l'utilisateur
                            - (B) A l'adresse du site Internet depuis lequel l'utilisateur est arrivé sur le site
                            - (C) A l'adresse du site Internet le plus référencé par le site visité par l'utilisateur
                            - (D) Au référend du site Internet, c'est à dire son propriétaire ou responsable
                            - (E) Aucune réponse correcte
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                          ## <i class="fas fa-question-circle"></i> Question 9
                          Which of the following protocol chains will be created by `Object.assign(Apple.prototype, Fruit.prototype)`, assuming `Apple` and `Fruit` originally both inherit from `Object` only.

                          - (A) `Apple` -> `Fruit` -> `Object`
                          - (B) `Fruit` -> `Apple` -> `Object`
                          - (C) `Apple` -> `Object` et `Fruit` -> `Object`
                          - (D) Aucune des réponses ci-dessus.
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                      <textarea data-template>
                        ## <i class="fas fa-question-circle"></i> Question 10

                        Qu'affichera le code suivant ?

                        ```js
                        let person = {
                            name: "John"
                        };
                        let student = {
                            studentId: 42
                        };
                        Object.assign(person, student);
                        student.studentId = 43;

                        console.log(person.studentId);
                        ```

                        - (A) `42`
                        - (B) `43`
                        - (C) `undefined`

                        Notes:

                        <div class="spoiler">

                          Réponse (A).

                          `Object.assign` ne fait que **copier** les propriétés énumérables et "owned" de l'objet source (ici `student`) dans l'objet destination `person`. Remplacer ou ajouter une propriété à l'objet source après un appel à `Object.assign` n'a donc pas d'effet sur l'objet destination.

                        </div>

                      </textarea>
                    </section>
                </section>

                <section>
                    <section data-background="#333333">
                        <h2><i class="fab fa-js"></i> Corrections</h2>
                    </section>
                    <section data-markdown style="font-size: 0.75em;">
                        <textarea data-template>
                            ## <i class="fab fa-js"></i> Exercice 3
                            <img src="images/ex3_screenshot.png"  style="width:600px; margin-top: 50px" />
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Questions
                        </textarea>
                    </section>
                </section>

                <section>
                    <section data-background="#333333">
                        <h2><i class="fab fa-js"></i> Javascript Arrays and Iterables</h2>
                    </section>
                    <section data-markdown style="font-size: 0.6em;">
                        <textarea data-template>
                            ## <i class="fab fa-js"></i> Arrays methods
                            Recall the Array object. Its prototype has many methods. Some of the useful ones are:

                            - `concat()` concatenates two or more arrays and returns a new array.
                            - `join()` joins all elements of an array into a string.
                            - `pop()` removes the last element from an array and returns that element.
                            - `push()` adds one or more elements to the end of an array and returns the new length of the array.
                            - `reverse()` reverses the order of the elements of an array.
                            - `shift()` removes the first element from an array and returns that element.
                            - `slice()` selects a part of an array, and returns it as a new array.
                            - `sort()` sorts the elements of an array.

                            https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array
                        
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.6em;">
                        <textarea data-template>
                            ## <i class="fab fa-js"></i> Array's functional methods (1/2)

                            The Array object also has some functional methods, which are:

                            `forEach()` executes a provided function once for each array element.

                            ```js
                            const a = ['a', 'b', 'c'];
                            a.forEach(element => console.log(element));
                            ```

                            `map()` creates a new array with the results of calling a provided function on every element.
                            
                            ```js
                            var a = ["apple", "banana", "pear"];
                            a.map(a => a.length)
                            ```

                            `flatMap()` maps each element using a mapping function, and then flattens the resulting array by one level.

                            ```js
                            var a = ['Yverdon is', 'a', 'beautiful city'];
                            a.flatMap(s => s.split(" "));
                            // First executes map: [['Yverdon', 'is'], 'a', ['beautiful', 'city']]
                            // Then flattens: ['Yverdon', 'is', 'a', 'beautiful', 'city'].
                            ```

                            `filter()` creates a new array with all elements that pass the test implemented by the provided function.

                            ```js
                            const words = ['Yverdon', 'is', 'a', 'beautiful', 'city'];
                            const result = words.filter(word => word.length > 6);
                            ```

                            https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array

                            Notes:

                            Flattenning an array by depth `n` means replacing any sub-array it contains with the elements contained by that subarray, `n` times. Note that a `flat` method exists in `Array.prototype` which does exactly that, meaning that `flatMap` is equivalent to calling `map` and then `flat`.
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.6em;">
                        <textarea data-template>
                            ## <i class="fab fa-js"></i> Array's functional methods (2/2)

                            `reduce()` and `reduceRight()` execute a reducer function on each element of the array, resulting in a single value.

                            ```js
                            var a = [1, 2, 3];
                            a.reduce((a, b) => a + b)
                            ```

                            `every()` tests whether all elements in the array pass the test implemented by the provided function.

                            ```js
                            var a = [1, 2, 3];
                            a.every(a => a > 0)
                            ```

                            `some()` tests whether some element in the array passes the test implemented by the provided function.

                            ```js
                            var a = [1, 2, 3];
                            a.some(a => a > 2)
                            ```

                            `find()` and `findIndex()` return the value (or its index, respectively) of the first element in the array that satisfies the provided testing function.

                            ```js
                            var a = [1, 2, 3];
                            a.find(a => a > 2)
                            ```

                            https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array

                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.6em;">
                        <textarea data-template>
                            ## <i class="fas fa-hand-paper"></i> Inverted Index

                            Given a list of documents, create an inverted index. An inverted index is a dictionary where each word is associated with a list of the document identifiers in which that word appears.

                            ```js
                            let documents = [
                                "Hello Everyone",
                                "Hello, World!",
                                "The sky is blue",
                                "The sky is dark"
                            ];
                            let stopWords = ["the", "is"];
                            let invertedIndex = "...";
                            ```

                            Use the `replace`, `split`, `filter`, `map`, `flatMap`, and `reduce` methods to create the inverted index so that `console.log(invertedIndex)` prints:

                            ```js
                            {
                                "hello": [ 0, 1 ],
                                "everyone": [ 0 ],
                                "world": [ 1 ],
                                "sky": [ 2, 3 ],
                                "blue": [ 2 ],
                                "dark": [ 3 ]
                            }
                            ```
                          
                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.6em">
                      <textarea data-template>
                        ## <i class="fab fa-js"></i> Iterators

                        **Iterators** are objects that provide a `next()` method which returns an object with two properties:

                        - `value`: the next value in the iterator, and
                        - `done`: whether the last value has already been provided.

                        **Iterables** are objects that have a `Symbol.iterator` method that returns an iterator over them.

                        ```js
                        let idGenerator = {};

                        idGenerator[Symbol.iterator] = function() {
                            return {
                                nextId: 0,
                                next() {
                                    if (this.nextId < 10) {
                                        return { value: this.nextId++, done: false };
                                    } else {
                                        return { done : true };
                                    }
                                }
                            }
                        }

                        for (let id of idGenerator) {
                            console.log(id);
                        }
                        ```

                        Notes:

                        *Recall: The `for...of` loop requires its second operand to be an iterable.*

                      </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.7em;">
                        <textarea data-template>
                            ## <i class="fab fa-js"></i> Generators - Convenient iterators

                            Allows the definition of a function that can "return multiple times" with the `yield` keyword:

                            ```js[3-8]
                            let idGenerator = {};

                            idGenerator[Symbol.iterator] = function* () {
                                let nextId = 0;
                                while (nextId < 10) {
                                    yield nextId++;
                                }
                            };

                            for (let id of idGenerator) {
                                console.log(id);
                            }
                            ```

                            - `function*` declares a generator, which is a type of iterator, *not* a function.
                            - `yield` effectively pauses execution after returning its operand. On a next call to the iterator, it will resume execution.
                            - `yield*` is followed by another generator or iterable object and delegates the generation to them until they are empty.

                            Notes:

                            ### Remarks

                            When used as a class method, since there is no `function` keyword, the asterisk is put before the name :
                            ```js
                            class Foo {
                                *bar() {
                                    yield 1;
                                }
                            }
                            ```

                            ### Exercise

                            Try defining generators that return
                            - the fibonacci sequence
                            - a sequence of numbers followed by their square : (1 1 2 4 3 9 4 16 ...)

                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fab fa-js"></i> Useful Built-in Iterables

                            The `Map` and `Set` objects are iterable and have a `forEach` method.


                            The `Map` object holds key-value pairs and remembers the original insertion order of the keys.

                            ```js
                            let map = new Map();
                            map.set("key", "value");
                            map.get("key");
                            map.delete("key");
                            ```

                            The `Set` object lets you store unique values of any type.

                            ```js
                            let set = new Set();
                            map.add("value");
                            map.has("value");
                            map.delete("value");
                            ```

                            https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Object

                        </textarea>
                    </section>
                </section>

                <section>
                    <section data-background="#333333">
                        <h2><i class="fab fa-js"></i> Testing JavaScript Applications</h2>
                    </section>
                    <section data-visibility="hidden" data-markdown style="font-size: 0.8em; text-align: center;">
                        <textarea data-template>
                            <img src="images/good_code.png" style="width: 30%;" />
                            
                            https://xkcd.com/844/
                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ##  <i class="fas fa-question-circle"></i> How to write good code?
                            
                            *If you haven't tested it, assume it is broken!*

                            But from where should I start?

                            Recall the cornerstones of computational thinking:
                            - Decomposition
                            - Data Representation / Pattern recognition
                            - Generalization / Abstraction
                            - Algorithm

                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            *The whole is greater than the sum of its parts.* 
                            **Aristotle**
                            <img src="images/car_disassembly.jpg"  style="width:600px; margin-top: 40px " />
                        </textarea>
                    </section>
                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ##  <i class="fas fa-check-square"></i> Test automation

                            In software testing, test automation is the use of a software separate from the software being tested to control the execution of tests and the comparison of actual outcomes with predicted outcomes.

                            https://en.wikipedia.org/wiki/Test_automation

                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em; text-align: center;">
                        <textarea data-template>
                            ##  <i class="fas fa-file-code"></i> Grab the code
                            
                            https://github.com/web-classroom/test-automation
                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em; text-align: center;">
                        <textarea data-template>
                            ##  <i class="fas fa-check-square"></i> Types of tests

                            <img src="images/tests.png"  style="width:60%;" />

                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em; ">
                        <textarea data-template>
                            ##  <i class="fas fa-cog"></i> Unit tests

                            - Test a **separable unit of software** for correctness, independently of the larger software System
                            - Employed as a **low-level** specification to ensure that a function or module performs as expected
                            - Usually fast to implement and execute
                            - **Example:** *testing that the subscriber's email is valid*

                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em; ">
                        <textarea data-template>
                            ##  <i class="fas fa-cogs"></i> Integration Tests

                            - Individual units of software that pass unit tests are **assembled together into components**
                            - Integration tests ensure that the components made of different parts work well together
                            - Sometimes slow to implement and execute
                            - **Example:** *test that the email was persisted in the subscriber table of the database*

                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em; ">
                        <textarea data-template>
                            ##  <i class="fas fa-car"></i> System Tests

                            - All the component that pass the integration tests are **assembled together into the system**
                            - System tests verify the **end-to-end functionality** of the system
                            - Usually **hard to automate** and very expensive to implement and execute
                            - **Example:** test that the user can subscribe to the mailing list b accessing the server from the chrome browser
                        </textarea>
                    </section>
                    
                    <section data-markdown style="font-size: 0.8em; ">
                        <textarea data-template>
                            ##  <i class="fas fa-clipboard"></i> Key takeaways

                            - If you haven't tested it, assume it is broken!
                            - Decomposition is the best friend of testable code
                            - When testing, write:
                               - A lot of unit tests
                               - Some integration tests
                               - Few selected system tests
                        </textarea>
                    </section>

                    <section data-markdown style="font-size: 0.8em; text-align: center;">
                        <textarea data-template>
                            <img src="images/sre.jpg" />

                            https://landing.google.com/sre/books/ 
                            
                            **Chapter 17:** Testing for Reliability
                        </textarea>
                    </section>


                    <section data-markdown style="font-size: 0.8em;">
                        <textarea data-template>
                            ## <i class="fas fa-question-circle"></i> Questions
                        </textarea>
                    </section>
                </section>

            </div>
		</div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/reveal.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/markdown/markdown.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/highlight/highlight.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.3.1/plugin/notes/notes.js"></script>
        <script src="./script.js" type="module"></script>

	</body>
</html>
